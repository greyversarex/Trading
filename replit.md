# Сканер Структур Графиков

Python-система для обнаружения визуально похожих ценовых структур на криптовалютных графиках в реальном времени.

## Обзор

Инструмент непрерывно сканирует криптовалютные рынки Binance и находит графики, ценовая структура которых визуально похожа на структуру, предоставленную пользователем через скриншот. Фокус на **структурном визуальном сходстве**, а не на числовых индикаторах.

## Архитектура проекта

```
├── src/backend/
│   ├── main.py              # FastAPI приложение с WebSocket
│   ├── image_processor.py   # Обработка изображений OpenCV
│   ├── structure_extractor.py # Детекция пивотов и извлечение фич
│   ├── similarity_matcher.py  # Геометрическое сопоставление
│   ├── binance_scanner.py     # Интеграция с Binance WebSocket
│   └── database.py            # SQLite хранилище
├── static/
│   └── index.html           # Фронтенд SPA с Tailwind CSS
├── data/                    # SQLite база данных
├── uploads/                 # Загруженные скриншоты
└── run.py                   # Точка входа
```

## Основные функции

### 1. Загрузка скриншотов
- Принимает скриншоты графиков с любой платформы
- Автоматически выделяет ценовую линию с помощью OpenCV
- Удаляет шум (UI, сетки, оси, метки)

### 2. Извлечение структуры
- Извлекает пивотные точки (локальные максимумы/минимумы)
- Вычисляет относительную геометрию между точками
- Измеряет тенденцию тренда, поведение сжатия/консолидации
- Классификация: Сжатие, Накопление, Треугольник, Диапазон, Ретест, Тренд

### 3. Сканирование рынка в реальном времени
- Подключение к Binance WebSocket API
- Мониторинг топ-50 торговых пар по объёму
- Мультитаймфреймный анализ: 1м, 3м, 5м, 15м, 30м, 1ч

### 4. Сопоставление по схожести
- Сравнение структура-к-структуре (не изображение-к-изображению)
- Геометрическое и реляционное сходство
- Зеркальная инвариантность (симметрия бычьих/медвежьих паттернов)
- Нормализованная оценка (0-100%)
- Настраиваемый порог

### 5. Обратная связь пользователя
- Кнопки "Релевантно" / "Нерелевантно" для каждого совпадения
- Система сохраняет обратную связь для обучения

## Технический стек

- **Бэкенд**: Python, FastAPI, OpenCV, NumPy, SciPy, scikit-learn
- **Фронтенд**: HTML, Tailwind CSS, Chart.js, WebSocket
- **База данных**: SQLite (via aiosqlite)
- **Данные рынка**: Binance WebSocket API

## Запуск приложения

```bash
python run.py
```

Сервер запускается на порту 5000.

## API Endpoints

- `POST /api/upload` - Загрузка скриншота графика
- `POST /api/start-scan` - Начать непрерывное сканирование
- `POST /api/stop-scan` - Остановить сканирование
- `POST /api/threshold` - Обновить порог схожести
- `POST /api/feedback` - Отправить обратную связь
- `GET /api/status` - Получить статус сканера
- `GET /api/structures` - Список сохранённых структур
- `GET /api/matches/{id}` - Получить совпадения для структуры
- `WS /ws` - WebSocket для обновлений в реальном времени

## Недавние изменения

- 2024-12: Полная реализация MVP
  - Конвейер обработки изображений с OpenCV
  - Извлечение структур с детекцией пивотов
  - Интеграция с Binance WebSocket
  - Сопоставление схожести в реальном времени
  - Русскоязычный веб-интерфейс
  - Кнопки обратной связи (релевантно/нерелевантно)
  - 6 таймфреймов (1м, 3м, 5м, 15м, 30м, 1ч)
